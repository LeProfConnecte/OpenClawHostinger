; =============================================================================
; Supervisor Configuration for OpenClaw on Hostinger VPS
; =============================================================================
;
; INSTALLATION:
;   sudo cp deploy/supervisor-openclaw.conf /etc/supervisor/conf.d/openclaw.conf
;   sudo supervisorctl reread
;   sudo supervisorctl update
;
; This file manages two processes:
;   1. openclaw-backend  - FastAPI backend via uvicorn
;   2. clawdbot-gateway  - The clawdbot gateway process
; =============================================================================

; --- FastAPI Backend (uvicorn) ---
[program:openclaw-backend]
command=/home/clp/htdocs/yourdomain.com/venv/bin/uvicorn server:app --host 127.0.0.1 --port 8000 --workers 1 --log-level info
directory=/home/clp/htdocs/yourdomain.com/backend
environment=
    MONGO_URL="mongodb://127.0.0.1:27017",
    DB_NAME="openclaw_app",
    CORS_ORIGINS="https://yourdomain.com",
    COOKIE_SECURE="true",
    COOKIE_SAMESITE="lax"
user=root
autostart=true
autorestart=true
startretries=5
startsecs=5
stopwaitsecs=30
redirect_stderr=true
stdout_logfile=/var/log/supervisor/openclaw-backend.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=3

; --- Clawdbot Gateway ---
; This process is started/stopped dynamically by the backend via supervisorctl
; autostart=false because the backend controls its lifecycle
[program:clawdbot-gateway]
command=/root/run_clawdbot.sh gateway --config /root/.clawdbot/clawdbot.json
directory=/root
environment=
    NODE_DIR="/root/nodejs",
    CLAWDBOT_DIR="/root/.clawdbot-bin",
    PATH="/root/nodejs/bin:/root/.clawdbot-bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
user=root
autostart=false
autorestart=unexpected
startretries=3
startsecs=5
stopwaitsecs=15
redirect_stderr=true
stdout_logfile=/var/log/supervisor/clawdbot-gateway.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=3
